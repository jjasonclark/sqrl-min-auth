CREATE TABLE IF NOT EXISTS users(
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY
);

CREATE TABLE IF NOT EXISTS sqrl(
  idk CHAR(44) PRIMARY KEY,
  user_id INT NOT NULL REFERENCES users(id),
  suk CHAR(44),
  vuk CHAR(44),
  enabled BOOLEAN DEFAULT TRUE,
  hardlock BOOLEAN DEFAULT FALSE,
  sqrlonly BOOLEAN DEFAULT FALSE,
  superseded TIMESTAMP
);

CREATE TABLE IF NOT EXISTS nuts(
  nut CHAR(44) PRIMARY KEY,
  code CHAR(44) NOT NULL,
  ip VARCHAR(50) NOT NULL,
  hmac CHAR(45),
  created TIMESTAMP DEFAULT NOW(),
  used TIMESTAMP,
  identified TIMESTAMP,
  user_id INT REFERENCES users(id),
  issued TIMESTAMP
);
